# 前言

本书将向您展示如何在 Android 应用程序中使用 OpenCV，该应用程序可显示相机供稿，保存和共享照片，操纵颜色和边缘以及以 2D 或 3D 方式跟踪真实世界的对象。 还引入了与 OpenGL 的集成，因此您可以开始构建增强现实（AR）应用程序，以将虚拟 3D 场景叠加到摄像机源中的跟踪对象上。

OpenCV 是一个开放源代码，跨平台的库，为计算机视觉实验和应用程序提供了构建基块。 它提供了高级界面来捕获，处理和显示图像数据。 例如，它抽象出有关相机硬件和阵列分配的详细信息。 OpenCV 在学术界和工业界都被广泛使用。

Android 是大多数开放源代码的移动操作系统。 对于 Java 开发人员，它提供了一个称为 Android SDK 的高级应用程序框架。 Android 应用程序具有模块化的高级界面，可以相互启动和共享数据，因此它们是模块化的。 移动性，高抽象度和数据共享是照片共享应用程序的良好起点，类似于我们将要构建的应用程序。

尽管 OpenCV 和 Android 提供了许多高级抽象（以及许多开放源代码供好奇的用户浏览），但对于新手来说，它们不一定易于使用。 建立适当的开发环境并将库的广泛功能转换为应用程序功能都是艰巨的任务。 这本简明的书通过强调简洁的设置，简洁的应用程序设计以及对每个功能用途的简单理解来帮助我们。

因为 OpenCV 的 Java 和 Android 绑定是相当新的，并且它们的文档还不成熟，所以对于此主题的书的需求特别大。 关于将 OpenCV 与 Android 的标准相机，媒体和图形 API 集成的步骤的文献很少。 当然，集成是应用程序开发人员工作的主要部分，因此这是本书的重点。

在我们共同的旅程结束时，您将体会到通过将 OpenCV 与其他 Android 库集成而实现的各种应用程序功能。 您将拥有自己的小型可重用类库，可以为将来的计算机视觉项目扩展或修改它们。 您将拥有一个开发环境和使用它的知识，并且您将能够制作更多的应用程序！

# 这本书涵盖的内容

第 1 章和“设置 OpenCV”涵盖了设置 OpenCV 和 Android 开发环境（包括 Eclipse 和 Android SDK）的步骤。

第 2 章和“使用相机框架”展示了如何将 OpenCV 集成到可以预览，捕获，保存和共享照片的 Android Java 应用程序中。

第 3 章，“应用图像效果”探索 OpenCV 的功能，可操纵颜色通道和像素邻域。 还介绍了 Apache Commons Math 库。 我们扩展了我们的应用程序，以包括通道混合滤镜，“曲线”滤镜和使边缘变暗的滤镜。

第 4 章，“识别和跟踪图像”演示了识别和跟踪已知目标（例如绘画）出现在视频供稿中时的步骤。 我们扩展我们的应用程序，以便它围绕任何跟踪的目标绘制轮廓。

第 5 章和“将图像跟踪与 3D 渲染相结合”通过确定目标在真实 3D 空间中的位置和旋转，改进了我们先前的跟踪技术。 我们扩展了我们的应用程序，以便它以与 Android 设备的真实相机相同的角度设置 OpenGL 3D 场景。 然后，我们在任何跟踪的目标上方绘制一个 3D 立方体。

第 6 章和“通过 JNI 混合 Java 和 C ++”演示了如何使用 Java 本机接口（JNI）从 Java 调用 C ++函数。 我们将一些应用程序的过滤器转换为 C ++，以了解如何使用 OpenCV 的 C ++接口编写高效的跨平台代码。

# 这本书需要什么

本书提供了有关 OpenCV 和 Android 开发环境（包括 Eclipse 和 Android SDK）的设置说明。 该软件是跨平台的，说明涵盖 Windows，Mac 和 Linux。 如果您愿意对设置步骤进行定制，则其他类似 Unix 的环境也可以使用。

您需要运行 Android 2.2（Froyo）或更高版本的移动设备，并且必须配备摄像头。 优选地，它应该有两个摄像头，前后两个。

# 这本书适合谁

本书非常适合那些对计算机视觉不熟悉并且喜欢通过应用程序开发学习的 Java 开发人员。 假定您以前有 Java 经验，但不一定具有 Android 经验。 对图像数据（例如，像素和颜色通道）的基本了解也将有所帮助。

# 约定

在本书中，您将找到许多可以区分不同类型信息的文本样式。 以下是这些样式的一些示例，并解释了其含义。

文本，数据库表名称，文件夹名称，文件名，文件扩展名，路径名，虚拟 URL，用户输入和 Twitter 句柄中的代码字显示如下：“它将通过 Android 的`MediaStore`与设备上的其他应用程序交互 和`Intent`类。”

代码块设置如下：

```java
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android=
  "http://schemas.android.com/apk/res/android"
  package="com.nummist.secondsight"
  android:versionCode="1"
  android:versionName="1.0">
```

当我们希望吸引我们注意代码块的特定部分时，相关的行或项以粗体显示：

```java
android:label="@string/app_name"
android:screenOrientation="landscape">
<intent-filter>
```

任何命令行输入或输出的编写方式如下：

```java
$ cd /etc/udev/rules.d/
$ sudo touch 51-android.rules

```

**新术语**和**重要词**以粗体显示。 您在屏幕上看到的字词，例如在菜单或对话框中的字样如下所示：“对于所有本机（C ++）项目，应重复这些步骤，其中包括 **OpenCV Sample –人脸检测**和 **OpenCV 教程 2-混合处理**。”

### 注意

警告或重要提示会出现在这样的框中。

### 提示

提示和技巧如下所示。

# 读者反馈

始终欢迎读者的反馈。 让我们知道您对这本书的看法-您喜欢或不喜欢的东西。 读者反馈对我们很重要，因为它可以帮助我们开发出您真正能充分利用的标题。

要向我们发送一般反馈，只需发送电子邮件`<[feedback@packtpub.com](mailto:feedback@packtpub.com)>`并在您的邮件主题中提及该书的标题。

如果您有专业知识的主题，并且对写作或撰写书籍感兴趣，请参阅 [www.packtpub.com/authors](http://www.packtpub.com/authors) 上的作者指南。

# 客户支持

既然您是 Packt 书的骄傲拥有者，我们可以通过很多方法来帮助您从购买中获得最大收益。

## 下载示例代码

您可以从 [http://www.packtpub.com](http://www.packtpub.com) 上的帐户下载示例代码文件，以获取所有购买的 Packt Publishing 图书。 如果您在其他地方购买了此书，则可以访问 [http://www.packtpub.com/support](http://www.packtpub.com/support) 并注册以将文件直接通过电子邮件发送给您。

## 下载本书的彩色图像

我们还为您提供了 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。 彩色图像将帮助您更好地了解输出中的变化。 您可以从 [https://www.packtpub.com/sites/default/files/downloads/B04598_Graphics.pdf](https://www.packtpub.com/sites/default/files/downloads/B04598_Graphics.pdf) 下载此文件。

## 勘误

尽管我们竭尽全力确保内容的准确性，但还是会发生错误。 如果您发现我们的其中一本书中有错误-可能是文本或代码中的错误-请将此报告给我们，我们将不胜感激。 这样，您可以使其他读者免于沮丧，并帮助我们改进本书的后续版本。 如果您发现任何勘误，请访问 [http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata) 进行报告，选择您的图书，点击**勘误提交表格**链接，然后 输入勘误的详细信息。 一旦您的勘误得到验证，您的提交将被接受，勘误将被上载到我们的网站或添加到该标题的勘误部分下的任何现有勘误列表中。

要查看先前提交的勘误，请转到 [https://www.packtpub.com/books/content/support](https://www.packtpub.com/books/content/support) ，然后在搜索字段中输入书籍的名称。 所需信息将出现在**勘误表**部分下。

## 盗版

互联网上受版权保护的材料的盗版在所有媒体中都是一个持续存在的问题。 在 Packt，我们非常重视版权和许可的保护。 如果您在 Internet 上以任何形式发现我们的作品的任何非法副本，请立即向我们提供位置地址或网站名称，以便我们寻求补救。

请通过`<[copyright@packtpub.com](mailto:copyright@packtpub.com)>`与我们联系，并提供指向可疑盗版材料的链接。

感谢您在保护我们的作者方面的帮助以及我们为您带来有价值的内容的能力。

## 问题

如果您对本书的任何方面都有疑问，可以通过`<[questions@packtpub.com](mailto:questions@packtpub.com)>`与我们联系，我们将尽力解决该问题。 您也可以直接通过`<[josephhowse@nummist.com](mailto:josephhowse@nummist.com)>`与作者联系，或者访问其网站 [http://nummist.com/opencv/](http://nummist.com/opencv/) ，以获取有关该书常见问题的答案。